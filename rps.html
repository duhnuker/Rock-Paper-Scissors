<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/home/dinuka/repos/Rock-Paper-Scissors/style.css">
    <title>Document</title>
</head>
<body>

    <div class="running-score">
        <span class="player-score">Player Score: </span>
        <span class="comp-score">Computer Score: </span>
    </div>

    <div class='container'>
        <button class="rock">Rock</button>
        <button class="paper">Paper</button>
        <button class="scissors">Scissors</button>
    </div>

    <div class="result"></div>

    <div class="winner"></div>

    <script>

    const rockButton = document.querySelector('.rock');
    const paperButton = document.querySelector('.paper');
    const scissorsButton = document.querySelector('.scissors');
    const resultDiv = document.querySelector('.result');
    const winnerDiv = document.querySelector('.winner');
    const playerScoreSpan = document.querySelector('.player-score');
    const compScoreSpan = document.querySelector('.comp-score');
    const p = document.createElement('p');


    let playerScore = 0;
    let compScore = 0;

    function getComputerChoice() {
        let randomValue = Math.floor(Math.random()*3); //random value range 0-3//

        if (randomValue === 0) {
            return 'rock';
        } else if (randomValue === 1) {
            return 'paper'; 
        } else {
            return 'scissors';
        }
    }


    //Takes user input, converts to lowercase viable input otherwise asks again for a valid input)//
    function playerSelection(userInput) {
        if (userInput.toLowerCase() === 'rock') {
            return userInput;
        } else if (userInput.toLowerCase() === 'paper') {
            return userInput;
        } else if (userInput.toLowerCase() === 'scissors') {
            return userInput;
        } else {console.log('That is not a valid option.')}
    };


    //User input is compared to randomly selected computerSelection to determine who wins the round. +1 is added to
    //whoever the winner of the round, that being playerScore or compScore. is. A console log is also returned presenting the result in
    //the players pov
    function playRound(playerSelection, computerSelection) {
        switch (playerSelection) {
            case 'rock':
                if (computerSelection == 'rock') {
                    p.innerText = 'Draw!';
                    resultDiv.appendChild(p);
                } else if (computerSelection == 'paper') {
                    compScore++;
                    p.innerText = 'You lose! Paper beats rock';
                    resultDiv.appendChild(p);
                } else {
                    playerScore++;
                    p.innerText = 'You win! Rock beats Scissors';
                    resultDiv.appendChild(p);
                }
                break;
            case 'paper':
                if (computerSelection == 'paper') {
                    p.innerText = 'Draw!';
                    resultDiv.appendChild(p);
                } else if (computerSelection == 'scissors') {
                    compScore++;
                    p.innerText = 'You lose! Scissors beats Paper';
                    resultDiv.appendChild(p);
                } else {
                    playerScore++;
                    p.innerText = 'You win! Paper beats Rock';
                    resultDiv.appendChild(p);
                }
                break;
            case 'scissors':
                if (computerSelection == 'scissors') {
                    p.innerText = 'Draw!';
                    resultDiv.appendChild(p);
                } else if (computerSelection == 'rock') {
                    compScore++;
                    p.innerText = 'You lose! Rock beats Scissors';
                    resultDiv.appendChild(p);
                } else {
                    playerScore++;
                    p.innerText = 'You win! Scissors beats Paper';
                    resultDiv.appendChild(p);
                }
                break;
        }
    }

    function endGame() {
        document.querySelector('.rock').disabled = true;
        document.querySelector('.paper').disabled = true;
        document.querySelector('.scissors').disabled = true;
    }

    const checkForWinner = (playerScore, compScore) => {
        const h1 = document.createElement('h1');
        if (playerScore === 5) {
            h1.innerText = 'You beat the computer, well done!'
            winnerDiv.appendChild(h1);
            endGame();
        } else if (compScore === 5) {
            h1.innerText = 'You lost to the computer, bad luck!'
            winnerDiv.appendChild(h1);
            endGame();
        }
    }

    const updateScores = (playerScore, compScore) => {
        playerScoreSpan.innerText = `Player Score:  ${playerScore}`;
        compScoreSpan.innerText = `Computer Score:  ${compScore}`;
    }


    rockButton.addEventListener('click', () => {
      const computerSelection = getComputerChoice() //gets computer selection when player selects rock//
      const playerSelection = 'rock' //player selection, this case player clicked button rock//
      playRound(playerSelection, computerSelection);
      updateScores(playerScore, compScore);
      checkForWinner(playerScore, compScore);
    })

    paperButton.addEventListener('click', () => {
      const computerSelection = getComputerChoice() //gets computer selection when player selects rock//
      const playerSelection = 'paper' //player selection, this case player clicked button rock//
      playRound(playerSelection, computerSelection);
      updateScores(playerScore, compScore);
      checkForWinner(playerScore, compScore);
    })

    scissorsButton.addEventListener('click', () => {
      const computerSelection = getComputerChoice() //gets computer selection when player selects rock//
      const playerSelection = 'scissors' //player selection, this case player clicked button rock//
      playRound(playerSelection, computerSelection);
      updateScores(playerScore, compScore);
      checkForWinner(playerScore, compScore);
    })

    //Making use of the other established functions, the game function uses a for loop that makes it so the functions are repeated
    //5 times. This function prompts for userinput, takes the generated computer selection and plays the rounds.
    //A console log is also returned each round updating the score
    //After the for loop is done, the winner, or a tie is returned finally
    /* function game() {
            for (let i = 0; i < 5; i++) {
            let playerSelection = prompt('Please type in your selection', 'Rock, Paper, Scissors').toLowerCase();
            let computerSelection = getComputerChoice();
            playRound(playerSelection, computerSelection);
           
        } 

        if (playerScore > compScore) {
            return 'You beat the Computer! Well Done!';
        } else if (playerScore < compScore) {
            return 'You lost to the Computer! Bad luck!';
        } else {
            return 'It is a tie!';
        }
    }

    */

    </script>
    
</body>
</html>